{"version":3,"file":"deletequestion.min.js","sources":["../src/deletequestion.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Delete question item js logic.\n *\n * @copyright  2021 onwards Willian Mano {@link http://conecti.me}\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/str', 'mod_cfp/sweetalert'], function($, Ajax, Str, Swal) {\n    var STRINGS = {\n        CONFIRM_TITLE: 'Are you sure?',\n        CONFIRM_MSG: 'Once deleted, this item cannot be recovered!',\n        CONFIRM_YES: 'Yes, delete it!',\n        CONFIRM_NO: 'Cancel',\n        SUCCESS: 'Item successfully deleted.'\n    };\n\n    var componentStrings = [\n        {\n            key: 'deletequestion_confirm_title',\n            component: 'mod_cfp'\n        },\n        {\n            key: 'deletequestion_confirm_msg',\n            component: 'mod_cfp'\n        },\n        {\n            key: 'deletequestion_confirm_yes',\n            component: 'mod_cfp'\n        },\n        {\n            key: 'deletequestion_confirm_no',\n            component: 'mod_cfp'\n        },\n        {\n            key: 'deletequestion_success',\n            component: 'mod_cfp'\n        },\n    ];\n\n    var DeleteQuestion = function() {\n        this.getStrings();\n\n        this.registerEventListeners();\n    };\n\n    DeleteQuestion.prototype.getStrings = function() {\n        var stringsPromise = Str.get_strings(componentStrings);\n\n        $.when(stringsPromise).done(function(strings) {\n            STRINGS.CONFIRM_TITLE = strings[0];\n            STRINGS.CONFIRM_MSG = strings[1];\n            STRINGS.CONFIRM_YES = strings[2];\n            STRINGS.CONFIRM_NO = strings[3];\n            STRINGS.SUCCESS = strings[4];\n        });\n    };\n\n    DeleteQuestion.prototype.registerEventListeners = function() {\n        $(\"body\").on(\"click\", \".delete-question\", function(event) {\n            event.preventDefault();\n\n            var eventTarget = $(event.currentTarget);\n\n            Swal.fire({\n                title: STRINGS.CONFIRM_TITLE,\n                text: STRINGS.CONFIRM_MSG,\n                icon: 'warning',\n                showCancelButton: true,\n                confirmButtonColor: '#3085d6',\n                cancelButtonColor: '#d33',\n                confirmButtonText: STRINGS.CONFIRM_YES,\n                cancelButtonText: STRINGS.CONFIRM_NO\n            }).then(function(result) {\n                if (result.value) {\n                    this.deleteGradeitem(eventTarget);\n                }\n            }.bind(this));\n        }.bind(this));\n    };\n\n    DeleteQuestion.prototype.deleteGradeitem = function(eventTarget) {\n        var request = Ajax.call([{\n            methodname: 'mod_cfp_deletequestion',\n            args: {\n                question: {\n                    id: eventTarget.data('id')\n                }\n            }\n        }]);\n\n        request[0].done(function() {\n            this.removeGradeItemLine(eventTarget);\n        }.bind(this)).fail(function(error) {\n            var message = error.message;\n\n            if (!message) {\n                message = error.error;\n            }\n            this.showToast('error', message);\n        }.bind(this));\n    };\n\n    DeleteQuestion.prototype.removeGradeItemLine = function(eventTarget) {\n        var tableLine = eventTarget.closest('tr');\n\n        tableLine.fadeOut(\"normal\", function() {\n            $(this).remove();\n        });\n\n        this.showToast('success', STRINGS.SUCCESS);\n    };\n\n    DeleteQuestion.prototype.showToast = function(type, message) {\n        var Toast = Swal.mixin({\n            toast: true,\n            position: 'top-end',\n            showConfirmButton: false,\n            timer: 8000,\n            timerProgressBar: true,\n            onOpen: (toast) => {\n                toast.addEventListener('mouseenter', Swal.stopTimer);\n                toast.addEventListener('mouseleave', Swal.resumeTimer);\n            }\n        });\n\n        Toast.fire({\n            icon: type,\n            title: message\n        });\n    };\n\n    return {\n        'init': function() {\n            return new DeleteQuestion();\n        }\n    };\n});"],"names":["define","$","Ajax","Str","Swal","STRINGS","CONFIRM_TITLE","CONFIRM_MSG","CONFIRM_YES","CONFIRM_NO","SUCCESS","componentStrings","key","component","DeleteQuestion","this","getStrings","registerEventListeners","prototype","stringsPromise","get_strings","when","done","strings","on","event","preventDefault","eventTarget","currentTarget","fire","title","text","icon","showCancelButton","confirmButtonColor","cancelButtonColor","confirmButtonText","cancelButtonText","then","result","value","deleteGradeitem","bind","call","methodname","args","question","id","data","removeGradeItemLine","fail","error","message","showToast","closest","fadeOut","remove","type","mixin","toast","position","showConfirmButton","timer","timerProgressBar","onOpen","addEventListener","stopTimer","resumeTimer","init"],"mappings":";;;;;;AAsBAA,gCAAO,CAAC,SAAU,YAAa,WAAY,uBAAuB,SAASC,EAAGC,KAAMC,IAAKC,MACrF,IAAIC,QAAU,CACVC,cAAe,gBACfC,YAAa,+CACbC,YAAa,kBACbC,WAAY,SACZC,QAAS,8BAGTC,iBAAmB,CACnB,CACIC,IAAK,+BACLC,UAAW,WAEf,CACID,IAAK,6BACLC,UAAW,WAEf,CACID,IAAK,6BACLC,UAAW,WAEf,CACID,IAAK,4BACLC,UAAW,WAEf,CACID,IAAK,yBACLC,UAAW,YAIfC,eAAiB,WACjBC,KAAKC,aAELD,KAAKE,0BAyFT,OAtFAH,eAAeI,UAAUF,WAAa,WAClC,IAAIG,eAAiBhB,IAAIiB,YAAYT,kBAErCV,EAAEoB,KAAKF,gBAAgBG,MAAK,SAASC,SACjClB,QAAQC,cAAgBiB,QAAQ,GAChClB,QAAQE,YAAcgB,QAAQ,GAC9BlB,QAAQG,YAAce,QAAQ,GAC9BlB,QAAQI,WAAac,QAAQ,GAC7BlB,QAAQK,QAAUa,QAAQ,OAIlCT,eAAeI,UAAUD,uBAAyB,WAC9ChB,EAAE,QAAQuB,GAAG,QAAS,mBAAoB,SAASC,OAC/CA,MAAMC,iBAEN,IAAIC,YAAc1B,EAAEwB,MAAMG,eAE1BxB,KAAKyB,KAAK,CACNC,MAAOzB,QAAQC,cACfyB,KAAM1B,QAAQE,YACdyB,KAAM,UACNC,kBAAkB,EAClBC,mBAAoB,UACpBC,kBAAmB,OACnBC,kBAAmB/B,QAAQG,YAC3B6B,iBAAkBhC,QAAQI,aAC3B6B,KAAK,SAASC,QACTA,OAAOC,OACPzB,KAAK0B,gBAAgBd,cAE3Be,KAAK3B,QACT2B,KAAK3B,QAGXD,eAAeI,UAAUuB,gBAAkB,SAASd,aAClCzB,KAAKyC,KAAK,CAAC,CACrBC,WAAY,yBACZC,KAAM,CACFC,SAAU,CACNC,GAAIpB,YAAYqB,KAAK,WAKzB,GAAG1B,KAAK,WACZP,KAAKkC,oBAAoBtB,cAC3Be,KAAK3B,OAAOmC,KAAK,SAASC,OACxB,IAAIC,QAAUD,MAAMC,QAEfA,UACDA,QAAUD,MAAMA,OAEpBpC,KAAKsC,UAAU,QAASD,UAC1BV,KAAK3B,QAGXD,eAAeI,UAAU+B,oBAAsB,SAAStB,aACpCA,YAAY2B,QAAQ,MAE1BC,QAAQ,UAAU,WACxBtD,EAAEc,MAAMyC,YAGZzC,KAAKsC,UAAU,UAAWhD,QAAQK,UAGtCI,eAAeI,UAAUmC,UAAY,SAASI,KAAML,SACpChD,KAAKsD,MAAM,CACnBC,OAAO,EACPC,SAAU,UACVC,mBAAmB,EACnBC,MAAO,IACPC,kBAAkB,EAClBC,OAAQ,SAACL,OACLA,MAAMM,iBAAiB,aAAc7D,KAAK8D,WAC1CP,MAAMM,iBAAiB,aAAc7D,KAAK+D,gBAI5CtC,KAAK,CACPG,KAAMyB,KACN3B,MAAOsB,WAIR,CACHgB,KAAQ,WACJ,OAAO,IAAItD"}